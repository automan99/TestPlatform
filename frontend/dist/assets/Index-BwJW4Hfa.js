import{r as y,a as j,B as W,c as X,o as Y,b as e,w as n,E as Z,a9 as ee,u as te,l as E,h as ae,q as s,ad as le,ae as ne,a4 as se,a5 as oe,$ as ue,k as c,t as r,j as de,af as re,ag as ie,f as pe,a2 as me,a3 as ce,g as _e,ao as fe,aq as ge,y as V,ap as be}from"./index-vTAAATWV.js";/* empty css                  *//* empty css                     *//* empty css                             *//* empty css                 *//* empty css                   */import"./index-BRBj6Fej.js";/* empty css                        *//* empty css               *//* empty css                *//* empty css                      *//* empty css               *//* empty css                        */import{a as xe}from"./index-j7d3t5fE.js";import{u as ve,t as w}from"./tenant-CEzwzZBB.js";import{_ as ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ve={class:"tenant-page"},we={class:"page-header"},Ee={class:"toolbar"},Se={__name:"Index",setup(he){const I=te(),{t}=xe(),P=ve(),D=y(),f=y(!1),S=y(""),h=y(!1),U=y([]),v=j({keyword:"",status:""}),i=j({page:1,pageSize:20,total:0}),u=j({id:null,name:"",code:"",description:"",max_users:10,max_projects:5,max_storage_gb:10,expireDate:"",status:"active"}),B={name:[{required:!0,message:"Please enter tenant name",trigger:"blur"}],code:[{required:!0,message:"Please enter tenant code",trigger:"blur"}]};function $(o){return{active:"success",suspended:"warning",expired:"danger"}[o]||"info"}function q(o){return{active:t("tenant.statusActive"),suspended:t("tenant.statusSuspended"),expired:t("tenant.statusExpired")}[o]||o}async function _(){var a,d;const o=await w.getList({page:i.page,per_page:i.pageSize,...v});U.value=((a=o.data)==null?void 0:a.items)||[],i.total=((d=o.data)==null?void 0:d.total)||0}function A(){h.value=!1,S.value=t("tenant.create"),Object.assign(u,{id:null,name:"",code:"",description:"",max_users:10,max_projects:5,max_storage_gb:10,expireDate:"",status:"active"}),f.value=!0}function F(o){h.value=!0,S.value=t("tenant.edit"),Object.assign(u,{id:o.id,name:o.name,code:o.code,description:o.description,max_users:o.max_users,max_projects:o.max_projects,max_storage_gb:o.max_storage_gb,expireDate:o.expire_date||"",status:o.status}),f.value=!0}function N(o){be.confirm(t("tenant.deleteConfirm"),t("common.confirm"),{type:"warning"}).then(async()=>{await w.delete(o.id),V.success(t("tenant.deleteSuccess")),_()})}function O(){D.value.validate(async o=>{if(o){const a={...u,expire_date:u.expireDate?new Date(u.expireDate).toISOString().split("T")[0]:null};delete a.expireDate,h.value?(await w.update(u.id,a),V.success(t("tenant.updateSuccess"))):(await w.create(a),V.success(t("tenant.createSuccess"))),f.value=!1,_()}})}async function R(o){var a,d;try{await w.switch(o.id),await P.setCurrentTenant(o.id),V.success(t("tenant.switchSuccess")),I.push("/dashboard")}catch(g){V.error(((d=(a=g.response)==null?void 0:a.data)==null?void 0:d.message)||t("tenant.switchFailed"))}}return W(()=>{_()}),(o,a)=>{const d=de,g=ae,b=ne,z=le,p=oe,M=ue,L=se,G=re,H=Z,m=_e,x=ce,k=me,C=fe,J=ge,K=pe,Q=ee;return Y(),X("div",Ve,[e(H,null,{header:n(()=>[E("div",we,[E("span",null,r(s(t)("tenant.title")),1),e(d,{type:"primary",icon:s(ie),onClick:A},{default:n(()=>[c(r(s(t)("tenant.create")),1)]),_:1},8,["icon"])])]),default:n(()=>[E("div",Ee,[e(g,{modelValue:v.keyword,"onUpdate:modelValue":a[0]||(a[0]=l=>v.keyword=l),placeholder:s(t)("tenant.searchPlaceholder"),clearable:"",style:{width:"200px"},onChange:_},null,8,["modelValue","placeholder"]),e(z,{modelValue:v.status,"onUpdate:modelValue":a[1]||(a[1]=l=>v.status=l),placeholder:s(t)("tenant.status"),clearable:"",onChange:_},{default:n(()=>[e(b,{label:s(t)("tenant.statusActive"),value:"active"},null,8,["label"]),e(b,{label:s(t)("tenant.statusSuspended"),value:"suspended"},null,8,["label"]),e(b,{label:s(t)("tenant.statusExpired"),value:"expired"},null,8,["label"])]),_:1},8,["modelValue","placeholder"]),a[14]||(a[14]=E("div",{style:{flex:"1"}},null,-1))]),e(L,{data:U.value,style:{width:"100%"}},{default:n(()=>[e(p,{prop:"name",label:s(t)("tenant.name")},null,8,["label"]),e(p,{prop:"code",label:s(t)("tenant.code"),width:"120"},null,8,["label"]),e(p,{prop:"status",label:s(t)("tenant.status"),width:"100"},{default:n(({row:l})=>[e(M,{type:$(l.status)},{default:n(()=>[c(r(q(l.status)),1)]),_:2},1032,["type"])]),_:1},8,["label"]),e(p,{prop:"users_count",label:s(t)("tenant.users"),width:"100"},null,8,["label"]),e(p,{prop:"projects_count",label:s(t)("tenant.projects"),width:"100"},null,8,["label"]),e(p,{prop:"max_users",label:s(t)("tenant.maxUsers"),width:"100"},null,8,["label"]),e(p,{prop:"expire_date",label:s(t)("tenant.expireDate"),width:"120"},{default:n(({row:l})=>[c(r(l.expire_date||"-"),1)]),_:1},8,["label"]),e(p,{label:s(t)("common.operation"),width:"180",fixed:"right"},{default:n(({row:l})=>[e(d,{type:"primary",link:"",size:"small",onClick:T=>R(l)},{default:n(()=>[c(r(s(t)("tenant.switch")),1)]),_:1},8,["onClick"]),e(d,{type:"primary",link:"",size:"small",onClick:T=>F(l)},{default:n(()=>[c(r(s(t)("common.edit")),1)]),_:1},8,["onClick"]),e(d,{type:"danger",link:"",size:"small",onClick:T=>N(l)},{default:n(()=>[c(r(s(t)("common.delete")),1)]),_:1},8,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"]),e(G,{"current-page":i.page,"onUpdate:currentPage":a[2]||(a[2]=l=>i.page=l),"page-size":i.pageSize,"onUpdate:pageSize":a[3]||(a[3]=l=>i.pageSize=l),total:i.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:_,onSizeChange:_,style:{"margin-top":"20px","justify-content":"flex-end"}},null,8,["current-page","page-size","total"])]),_:1}),e(Q,{modelValue:f.value,"onUpdate:modelValue":a[13]||(a[13]=l=>f.value=l),title:S.value,width:"700px","destroy-on-close":""},{footer:n(()=>[e(d,{onClick:a[12]||(a[12]=l=>f.value=!1)},{default:n(()=>[c(r(s(t)("common.cancel")),1)]),_:1}),e(d,{type:"primary",onClick:O},{default:n(()=>[c(r(s(t)("common.confirm")),1)]),_:1})]),default:n(()=>[e(K,{model:u,rules:B,ref_key:"formRef",ref:D,"label-width":"120px"},{default:n(()=>[e(k,{gutter:20},{default:n(()=>[e(x,{span:12},{default:n(()=>[e(m,{label:s(t)("tenant.name"),prop:"name"},{default:n(()=>[e(g,{modelValue:u.name,"onUpdate:modelValue":a[4]||(a[4]=l=>u.name=l)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(x,{span:12},{default:n(()=>[e(m,{label:s(t)("tenant.code"),prop:"code"},{default:n(()=>[e(g,{modelValue:u.code,"onUpdate:modelValue":a[5]||(a[5]=l=>u.code=l),placeholder:"e.g., acme"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(m,{label:s(t)("tenant.description"),prop:"description"},{default:n(()=>[e(g,{modelValue:u.description,"onUpdate:modelValue":a[6]||(a[6]=l=>u.description=l),type:"textarea",rows:3},null,8,["modelValue"])]),_:1},8,["label"]),e(k,{gutter:20},{default:n(()=>[e(x,{span:12},{default:n(()=>[e(m,{label:s(t)("tenant.maxUsers"),prop:"max_users"},{default:n(()=>[e(C,{modelValue:u.max_users,"onUpdate:modelValue":a[7]||(a[7]=l=>u.max_users=l),min:1,style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(x,{span:12},{default:n(()=>[e(m,{label:s(t)("tenant.maxProjects"),prop:"max_projects"},{default:n(()=>[e(C,{modelValue:u.max_projects,"onUpdate:modelValue":a[8]||(a[8]=l=>u.max_projects=l),min:1,style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(k,{gutter:20},{default:n(()=>[e(x,{span:12},{default:n(()=>[e(m,{label:s(t)("tenant.maxStorage"),prop:"max_storage_gb"},{default:n(()=>[e(C,{modelValue:u.max_storage_gb,"onUpdate:modelValue":a[9]||(a[9]=l=>u.max_storage_gb=l),min:1,style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(x,{span:12},{default:n(()=>[e(m,{label:s(t)("tenant.expireDate"),prop:"expire_date"},{default:n(()=>[e(J,{modelValue:u.expireDate,"onUpdate:modelValue":a[10]||(a[10]=l=>u.expireDate=l),type:"date",placeholder:"Select date",style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(m,{label:s(t)("tenant.status"),prop:"status"},{default:n(()=>[e(z,{modelValue:u.status,"onUpdate:modelValue":a[11]||(a[11]=l=>u.status=l),style:{width:"100%"}},{default:n(()=>[e(b,{label:s(t)("tenant.statusActive"),value:"active"},null,8,["label"]),e(b,{label:s(t)("tenant.statusSuspended"),value:"suspended"},null,8,["label"]),e(b,{label:s(t)("tenant.statusExpired"),value:"expired"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},Re=ye(Se,[["__scopeId","data-v-fa223667"]]);export{Re as default};
