import{r as V,a as E,B as Q,c as W,o as X,b as e,w as a,E as Y,a9 as Z,u as ee,l as c,h as le,ad as te,ae,a4 as oe,a5 as ne,$ as ue,k as m,t as U,j as ie,af as re,f as se,g as de,a2 as pe,a3 as me,ap as fe,y as T}from"./index-vTAAATWV.js";/* empty css                  *//* empty css                     *//* empty css               *//* empty css                *//* empty css                      *//* empty css               *//* empty css                   *//* empty css                 *//* empty css                        */import"./index-BRBj6Fej.js";import{d as w}from"./defect-pEhMI9Tv.js";import{_ as ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ge={class:"defect-page"},be={class:"page-header"},_e={class:"toolbar"},ye={__name:"Index",setup(Ve){const B=ee(),h=V(),_=V(!1),x=V(""),y=V(!1),z=V([]),d=E({keyword:"",severity:"",priority:"",status:""}),f=E({page:1,pageSize:20,total:0}),o=E({id:null,title:"",description:"",severity:"medium",priority:"medium",status:"new",defect_type:"bug",assigned_to:"",environment:"",browser:"",os:"",reproduction_steps:"",expected_behavior:"",actual_behavior:""}),$={title:[{required:!0,message:"请输入缺陷标题",trigger:"blur"}]};function j(u){return{critical:"danger",high:"warning",medium:"primary",low:"info",trivial:"info"}[u]||"info"}function I(u){return{critical:"紧急",high:"高",medium:"中",low:"低",trivial:"轻微"}[u]||u}function P(u){return{urgent:"danger",high:"warning",medium:"primary",low:"info"}[u]||"info"}function D(u){return{urgent:"紧急",high:"高",medium:"中",low:"低"}[u]||u}function R(u){return{new:"info",assigned:"warning",in_progress:"primary",resolved:"success",closed:"info"}[u]||"info"}function F(u){return{new:"新建",assigned:"已分配",in_progress:"进行中",resolved:"已解决",closed:"已关闭"}[u]||u}async function p(){var l,r;const u=await w.getList({page:f.page,per_page:f.pageSize,...d});z.value=((l=u.data)==null?void 0:l.items)||[],f.total=((r=u.data)==null?void 0:r.total)||0}function M(){y.value=!1,x.value="新建缺陷",Object.assign(o,{id:null,title:"",description:"",severity:"medium",priority:"medium",status:"new",defect_type:"bug",assigned_to:"",environment:"",browser:"",os:"",reproduction_steps:"",expected_behavior:"",actual_behavior:""}),_.value=!0}function N(u){y.value=!0,x.value="编辑缺陷",Object.assign(o,u),_.value=!0}function O(u){B.push(`/defects/${u.id}`)}function L(u){fe.confirm("确定要删除这个缺陷吗？","提示",{type:"warning"}).then(()=>w.delete(u.id)).then(()=>{T.success("删除成功"),p()})}function q(){h.value.validate(u=>{if(u){const l=y.value?w.update:w.create,r=y.value?o.id:o;l(r,y.value?o:null).then(()=>{T.success(y.value?"更新成功":"创建成功"),_.value=!1,p()})}})}return Q(()=>{p()}),(u,l)=>{const r=ie,s=le,n=ae,b=te,v=ne,C=ue,A=oe,G=re,H=Y,i=de,g=me,k=pe,J=se,K=Z;return X(),W("div",ge,[e(H,null,{header:a(()=>[c("div",be,[l[22]||(l[22]=c("span",null,"缺陷管理",-1)),e(r,{type:"primary",icon:"Plus",onClick:M},{default:a(()=>[...l[21]||(l[21]=[m("新建缺陷",-1)])]),_:1})])]),default:a(()=>[c("div",_e,[e(s,{modelValue:d.keyword,"onUpdate:modelValue":l[0]||(l[0]=t=>d.keyword=t),placeholder:"搜索缺陷",clearable:"",style:{width:"200px"},onChange:p},null,8,["modelValue"]),e(b,{modelValue:d.severity,"onUpdate:modelValue":l[1]||(l[1]=t=>d.severity=t),placeholder:"严重程度",clearable:"",onChange:p},{default:a(()=>[e(n,{label:"紧急",value:"critical"}),e(n,{label:"高",value:"high"}),e(n,{label:"中",value:"medium"}),e(n,{label:"低",value:"low"})]),_:1},8,["modelValue"]),e(b,{modelValue:d.priority,"onUpdate:modelValue":l[2]||(l[2]=t=>d.priority=t),placeholder:"优先级",clearable:"",onChange:p},{default:a(()=>[e(n,{label:"紧急",value:"urgent"}),e(n,{label:"高",value:"high"}),e(n,{label:"中",value:"medium"}),e(n,{label:"低",value:"low"})]),_:1},8,["modelValue"]),e(b,{modelValue:d.status,"onUpdate:modelValue":l[3]||(l[3]=t=>d.status=t),placeholder:"状态",clearable:"",onChange:p},{default:a(()=>[e(n,{label:"新建",value:"new"}),e(n,{label:"已分配",value:"assigned"}),e(n,{label:"进行中",value:"in_progress"}),e(n,{label:"已解决",value:"resolved"}),e(n,{label:"已关闭",value:"closed"})]),_:1},8,["modelValue"]),l[23]||(l[23]=c("div",{style:{flex:"1"}},null,-1))]),e(A,{data:z.value,style:{width:"100%"}},{default:a(()=>[e(v,{prop:"defect_no",label:"编号",width:"120"}),e(v,{prop:"title",label:"标题","show-overflow-tooltip":""}),e(v,{prop:"severity",label:"严重程度",width:"100"},{default:a(({row:t})=>[e(C,{type:j(t.severity)},{default:a(()=>[m(U(I(t.severity)),1)]),_:2},1032,["type"])]),_:1}),e(v,{prop:"priority",label:"优先级",width:"100"},{default:a(({row:t})=>[e(C,{type:P(t.priority)},{default:a(()=>[m(U(D(t.priority)),1)]),_:2},1032,["type"])]),_:1}),e(v,{prop:"status",label:"状态",width:"100"},{default:a(({row:t})=>[e(C,{type:R(t.status)},{default:a(()=>[m(U(F(t.status)),1)]),_:2},1032,["type"])]),_:1}),e(v,{prop:"assigned_to",label:"分配给",width:"120"}),e(v,{prop:"reported_date",label:"报告日期",width:"120"}),e(v,{label:"操作",width:"180",fixed:"right"},{default:a(({row:t})=>[e(r,{type:"primary",link:"",size:"small",onClick:S=>O(t)},{default:a(()=>[...l[24]||(l[24]=[m("查看",-1)])]),_:1},8,["onClick"]),e(r,{type:"primary",link:"",size:"small",onClick:S=>N(t)},{default:a(()=>[...l[25]||(l[25]=[m("编辑",-1)])]),_:1},8,["onClick"]),e(r,{type:"danger",link:"",size:"small",onClick:S=>L(t)},{default:a(()=>[...l[26]||(l[26]=[m("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),e(G,{"current-page":f.page,"onUpdate:currentPage":l[4]||(l[4]=t=>f.page=t),"page-size":f.pageSize,"onUpdate:pageSize":l[5]||(l[5]=t=>f.pageSize=t),total:f.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:p,onSizeChange:p,style:{"margin-top":"20px","justify-content":"flex-end"}},null,8,["current-page","page-size","total"])]),_:1}),e(K,{modelValue:_.value,"onUpdate:modelValue":l[20]||(l[20]=t=>_.value=t),title:x.value,width:"800px","destroy-on-close":""},{footer:a(()=>[e(r,{onClick:l[19]||(l[19]=t=>_.value=!1)},{default:a(()=>[...l[27]||(l[27]=[m("取消",-1)])]),_:1}),e(r,{type:"primary",onClick:q},{default:a(()=>[...l[28]||(l[28]=[m("确定",-1)])]),_:1})]),default:a(()=>[e(J,{model:o,rules:$,ref_key:"formRef",ref:h,"label-width":"100px"},{default:a(()=>[e(i,{label:"缺陷标题",prop:"title"},{default:a(()=>[e(s,{modelValue:o.title,"onUpdate:modelValue":l[6]||(l[6]=t=>o.title=t)},null,8,["modelValue"])]),_:1}),e(k,{gutter:20},{default:a(()=>[e(g,{span:8},{default:a(()=>[e(i,{label:"严重程度",prop:"severity"},{default:a(()=>[e(b,{modelValue:o.severity,"onUpdate:modelValue":l[7]||(l[7]=t=>o.severity=t),style:{width:"100%"}},{default:a(()=>[e(n,{label:"紧急",value:"critical"}),e(n,{label:"高",value:"high"}),e(n,{label:"中",value:"medium"}),e(n,{label:"低",value:"low"}),e(n,{label:"轻微",value:"trivial"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(g,{span:8},{default:a(()=>[e(i,{label:"优先级",prop:"priority"},{default:a(()=>[e(b,{modelValue:o.priority,"onUpdate:modelValue":l[8]||(l[8]=t=>o.priority=t),style:{width:"100%"}},{default:a(()=>[e(n,{label:"紧急",value:"urgent"}),e(n,{label:"高",value:"high"}),e(n,{label:"中",value:"medium"}),e(n,{label:"低",value:"low"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(g,{span:8},{default:a(()=>[e(i,{label:"状态",prop:"status"},{default:a(()=>[e(b,{modelValue:o.status,"onUpdate:modelValue":l[9]||(l[9]=t=>o.status=t),style:{width:"100%"}},{default:a(()=>[e(n,{label:"新建",value:"new"}),e(n,{label:"已分配",value:"assigned"}),e(n,{label:"进行中",value:"in_progress"}),e(n,{label:"已解决",value:"resolved"}),e(n,{label:"已关闭",value:"closed"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(k,{gutter:20},{default:a(()=>[e(g,{span:12},{default:a(()=>[e(i,{label:"缺陷类型",prop:"defect_type"},{default:a(()=>[e(b,{modelValue:o.defect_type,"onUpdate:modelValue":l[10]||(l[10]=t=>o.defect_type=t),style:{width:"100%"}},{default:a(()=>[e(n,{label:"缺陷",value:"bug"}),e(n,{label:"功能",value:"feature"}),e(n,{label:"改进",value:"improvement"}),e(n,{label:"任务",value:"task"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(g,{span:12},{default:a(()=>[e(i,{label:"分配给",prop:"assigned_to"},{default:a(()=>[e(s,{modelValue:o.assigned_to,"onUpdate:modelValue":l[11]||(l[11]=t=>o.assigned_to=t)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(i,{label:"描述",prop:"description"},{default:a(()=>[e(s,{modelValue:o.description,"onUpdate:modelValue":l[12]||(l[12]=t=>o.description=t),type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),e(i,{label:"复现步骤",prop:"reproduction_steps"},{default:a(()=>[e(s,{modelValue:o.reproduction_steps,"onUpdate:modelValue":l[13]||(l[13]=t=>o.reproduction_steps=t),type:"textarea",rows:4},null,8,["modelValue"])]),_:1}),e(i,{label:"期望行为",prop:"expected_behavior"},{default:a(()=>[e(s,{modelValue:o.expected_behavior,"onUpdate:modelValue":l[14]||(l[14]=t=>o.expected_behavior=t),type:"textarea",rows:2},null,8,["modelValue"])]),_:1}),e(i,{label:"实际行为",prop:"actual_behavior"},{default:a(()=>[e(s,{modelValue:o.actual_behavior,"onUpdate:modelValue":l[15]||(l[15]=t=>o.actual_behavior=t),type:"textarea",rows:2},null,8,["modelValue"])]),_:1}),e(k,{gutter:20},{default:a(()=>[e(g,{span:8},{default:a(()=>[e(i,{label:"环境",prop:"environment"},{default:a(()=>[e(s,{modelValue:o.environment,"onUpdate:modelValue":l[16]||(l[16]=t=>o.environment=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(g,{span:8},{default:a(()=>[e(i,{label:"浏览器",prop:"browser"},{default:a(()=>[e(s,{modelValue:o.browser,"onUpdate:modelValue":l[17]||(l[17]=t=>o.browser=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(g,{span:8},{default:a(()=>[e(i,{label:"操作系统",prop:"os"},{default:a(()=>[e(s,{modelValue:o.os,"onUpdate:modelValue":l[18]||(l[18]=t=>o.os=t)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},je=ve(ye,[["__scopeId","data-v-37828001"]]);export{je as default};
